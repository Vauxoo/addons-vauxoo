<?xml version='1.0' encoding='UTF-8'?>
<openerp>
    <data noupdate="1">

        <record id="server_action_update_price_unit_move" model="ir.actions.server">
            <field name="name">Update price unit stock move</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'stock.move')]"/>
            <field name="state">code</field>
            <field name="code">
            if object.product_id.cost_method == 'average' and object.state == 'done' and object.location_dest_id.usage in ('customer', 'transit', 'inventory'):
                object.write({'price_unit': object.product_id.standard_price})
            </field>
        </record>
    </data>
</openerp>
